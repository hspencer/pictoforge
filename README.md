# PictoForge - Semantic SVG Editor

## About the Project

PictoForge is a semantic SVG editor designed as a companion tool for generative models. It provides a precise workspace for inspecting, editing, and auditing SVG pictograms generated by [PictoNet](https://github.com/mediafranca/pictonet). Within the broader MediaFranca initiative for Augmentative and Alternative Communication (AAC), PictoForge acts as the human-facing interface where machine-generated graphics become transparent, editable artefacts that can be adapted to specific communicative and cultural contexts.

The editor offers direct manipulation of SVG elements on a canvas that remains synchronised with the underlying code. A unified coordinate system and mathematically coherent transformation layer keep visual operations and textual representation aligned, so that every change made in the interface corresponds to a traceable, structured modification in the SVG source.


### Project Philosophy

PictoForge is built around the idea of round-trip editing between code and canvas. Visual selection, transformation, and styling always have a clear counterpart in the SVG DOM, and edits in the code view are reflected immediately in the graphical interface. This reciprocity turns the editor into an instrument for inspection, curation, and correction of generative output rather than a black box.

At the technical core, a central “world” model reconciles screen, viewport, and SVG coordinates so that all tools operate in a single coherent space. This architecture prioritises:

- Mathematical correctness in geometric operations
- Direct manipulation with fine-grained control of transforms
- Stable mapping between hierarchy, attributes, and visual feedback
- Round-trip workflows for reviewing and refining SVGs produced by PictoNet and related models

Within AAC workflows, this philosophy supports careful review of pictograms, systematic adjustment of form and style, and explicit documentation of changes, providing a clear bridge between generative engines and accountable, human-guided communication tools.

## Technology Stack

PictoForge is built with modern web technologies focusing on performance and developer experience.

### Core Technologies

- **React 19.1.0** - UI framework with concurrent features
- **Vite 6.3.5** - Fast build tool and development server
- **Node.js 18+** - Runtime environment
- **pnpm 10.4.1** - Fast, disk space efficient package manager

### Key Libraries

**SVG Manipulation**
- **@svgdotjs/svg.js 3.2.5** - SVG manipulation and transformations
- **@panzoom/panzoom 4.6.0** - Viewport pan and zoom
- **react-moveable 0.56.0** - Interactive dragging, resizing, and rotating

**User Interface**
- **Tailwind CSS 4.1.7** - Utility-first CSS framework
- **Radix UI** - Accessible component primitives
- **Lucide React 0.510.0** - Icon library
- **Framer Motion 12.15.0** - Animation library

**Development**
- **Vitest 3.2.4** - Unit testing framework
- **@testing-library/react 16.3.0** - Testing utilities

## Installation and Local Development

### Prerequisites

- Node.js 18 or higher
- npm or pnpm package manager

### Installation Steps

```bash
# Clone the repository
git clone https://github.com/hspencer/pictoforge.git
cd pictoforge

# Install dependencies
pnpm install
# or
npm install
```

### Development Server

```bash
# Start development server
pnpm run dev
# or
npm run dev

# Application will be available at http://localhost:5173
```

### Testing

```bash
pnpm test          # Run tests in watch mode
pnpm test:run      # Run tests once
pnpm test:ui       # Interactive test UI
pnpm test:coverage # Coverage report
```

### Production Build

```bash
# Build for production
pnpm run build
# or
npm run build

# Files will be generated in the 'dist/' directory
```

### Preview Production Build

```bash
# Preview production build locally
pnpm run preview
# or
npm run preview

# Application will be available at http://localhost:4173
```

## Project Roadmap

### Fully Functional Features

- SVG file loading (drag and drop, file button)
- SVG hierarchy parsing and visualisation
- Bidirectional selection (round-trip) between hierarchy and canvas
- CSS styles panel with dynamic application/removal
- Canvas zoom and pan
- Light/dark theme
- Internationalisation (ES/EN)
- Editable code view with line numbers
- SVG export
- History system (undo/redo)
- Performance metrics

### Partially Implemented Features

**Select Tool (Black Arrow)**
- Element selection (complete)
- BoundingBox with resize handles (complete)
- Element rotation (complete)
- Movement (implemented, needs refinement)
- Scaling (implemented, needs refinement)

**Node Tool (White Arrow)**
- Node visualisation in paths (complete)
- Node detection (complete)
- Node editing (structure present, logic in development)
- Bézier handle manipulation (structure present)

**Pen Tool**
- Path selection (complete)
- Add nodes (structure prepared)
- Remove nodes (structure prepared)
- Change node types (smooth/corner/bezier) (pending)

### Pending Implementation

**High Priority**
- Complete node editing tool (Node tool)
- Implement element duplication and deletion
- Improve transformation system (accumulation of transforms)
- Complete Pen tool for adding/removing nodes

**Medium Priority**
- Implement save system with scoring
- Add more unit tests (currently low coverage)
- Optimise performance for very large SVGs
- Improve SVG validation on load

**Low Priority**
- Language model API integration
- PNG/PDF export
- Template system
- Keyboard shortcuts

### Known Issues

1. **SVG Transformation Manipulation** ([SVGViewer.jsx:467-511](src/components/SVGViewer.jsx#L467-L511))
   - Resize and move transformations work but may accumulate incorrectly
   - Needs better handling of accumulated transformation matrix

2. **Node Editing** ([NodeEditor.jsx](src/components/NodeEditor.jsx))
   - Structure prepared but logic incomplete
   - Missing node drag implementation
   - Missing Bézier control handle implementation

3. **Pen Tool** ([SVGViewer.jsx:153-162](src/components/SVGViewer.jsx#L153-L162))
   - Prepared but without real functionality
   - TODO commented for add/remove nodes

4. **Duplication/Deletion** ([App.jsx:189-200](src/App.jsx#L189-L200))
   - Functions prepared but without implementation
   - Only register console.log

## Documentation

### Architecture Documentation

- [System Architecture](docs/architecture.md) - Overview of architecture and main components
- [Coordinate System](docs/coordinate-system.md) - Complete guide on coordinate transformations with SVGWorld
- [UI Overlay System](docs/ui-overlay-system.md) - Documentation on the overlay system for interactive editing
- [SCSS Architecture](docs/scss-architecture.md) - Style system organisation and conventions

### Interface Documentation

- [ASCII Interface Map](docs/ascii-divmap.md) - Complete structure of PictoForge interface with component names

### API and Functions

- [API Reference](docs/api-reference.md) - Complete API documentation for components, hooks, and utilities

### Legacy Documentation (Spanish)

The [docs](docs/) directory contains additional documentation in Spanish from earlier development phases:
- `ARQUITECTURA_FASE*.md` - Architecture documentation from phases 1-5
- `COORDENADAS.md` - Coordinate system documentation (Spanish)
- `TRANSFORMACION_COORDENADAS.md` - Coordinate transformation documentation (Spanish)

## File Structure

```
src/
├── App.jsx                          # [202 lines] Main component
├── components/
│   ├── SVGViewer.jsx               # [569 lines] Main viewer with tools
│   ├── SVGHierarchy.jsx            # [135 lines] Element tree
│   ├── TextInput.jsx               # Top input
│   ├── StylePanel.jsx              # CSS styles panel
│   ├── CodeView.jsx                # Editable code view
│   ├── BoundingBox.jsx             # Transformation box
│   ├── NodeEditor.jsx              # Node editor (in development)
│   ├── PerformanceMetrics.jsx      # Performance metrics
│   ├── CustomIcons.jsx             # Custom icons
│   ├── LanguageSelector.jsx        # Language selector
│   └── FileLoadDemo.jsx            # Load demo
├── hooks/
│   ├── useSVGParser.js             # SVG parsing hook
│   ├── useHistory.js               # Undo/redo hook
│   ├── usePerformance.js           # Optimisation hook
│   ├── useSVGWorld.js              # Coordinate system hook
│   └── useI18n.jsx                 # Internationalisation hook
├── services/
│   └── SVGWorld.js                 # Coordinate transformation service
├── utils/
│   └── svgManipulation.js          # SVG manipulation utilities
└── tests/
    ├── setup.js
    └── hooks/__tests__/
        ├── useSVGParser.test.js
        └── useHistory.test.js
```

## Main Features

### Three-Panel Interface

- **Top Panel**: Text input with SVG file loading by drag and drop
- **Left Panel**: SVG element hierarchy with appropriate icons and CSS styles panel
- **Central Panel**: Interactive SVG viewer with editing tools and alternative code view

### Bidirectional Selection (Round Trip Interface)

- Selecting elements in hierarchy highlights them in viewer
- Clicking SVG elements selects them in hierarchy
- Auto-expansion of path to selected elements

### Visual Editing Tools

- **Black Arrow (Select)**: Selection, movement, scaling, and rotation of complete entities with bounding box
- **White Arrow (Node)**: Editing of individual nodes in paths (select, move, adjust control points)
- **Pen**: Tool for adding/removing nodes and changing curve types
- **Coordinate transformation system**: Precise conversion between screen and SVG space (with support for zoom, pan, and viewBox)
- Zoom in/out, view reset, SVG download, undo/redo

### Style System

- Visualisation of CSS classes defined in SVG
- Dynamic application/removal of styles to elements
- Preview of CSS properties (fill, stroke, stroke-linejoin, etc.)

### Advanced Tools

- Save, undo/redo (prepared)
- Copy, duplicate, and delete elements (prepared)
- Editable SVG code view with line numbering
- Real-time statistics (number of elements and styles)

### Additional Features

- Light/dark theme
- Responsive and professional interface
- Smooth animations and micro-interactions
- Error handling and SVG file validation

## Contributing

This project is designed to be extensible. Main areas for contribution include:

1. **Editing Tools**: Implement visual editing functionalities
2. **AI Integration**: Connect with language models
3. **Export**: Add more export formats
4. **Performance**: Optimise for large and complex SVGs

## Licence

This project is licensed under the MIT Licence.

## Version

Current version: 0.0.1

---

PictoForge - Semantic SVG Editor
