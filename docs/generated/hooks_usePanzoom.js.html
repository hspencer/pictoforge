<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: hooks/usePanzoom.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: hooks/usePanzoom.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { useEffect, useRef, useState, useCallback } from 'react';
import Panzoom from '@panzoom/panzoom';

/**
 * Hook React para integrar @panzoom/panzoom
 * Proporciona control de zoom y pan con estado reactivo
 *
 * @param {Object} options - Opciones de configuración
 * @param {React.RefObject} options.elementRef - Ref al elemento que será pan/zoom
 * @param {Object} options.panzoomOptions - Opciones adicionales para panzoom
 * @returns {Object} API de panzoom y estado reactivo
 */
export function usePanzoom({ elementRef, panzoomOptions = {} } = {}) {
  const panzoomInstanceRef = useRef(null);
  const [panzoomState, setPanzoomState] = useState({
    scale: 1,
    x: 0,
    y: 0,
  });
  const [isReady, setIsReady] = useState(false);

  const element = elementRef?.current;

  /**
   * Inicializa panzoom en el elemento
   */
  useEffect(() => {
    if (!element || panzoomInstanceRef.current) {
      return;
    }

    // Configuración por defecto de panzoom
    const defaultOptions = {
      maxScale: 10,
      minScale: 0.1,
      step: 0.1,
      startScale: 1,
      startX: 0,
      startY: 0,
      cursor: 'grab',
      canvas: true, // Permite pan fuera de los límites
      contain: 'outside', // Permite pan sin restricciones
      ...panzoomOptions,
    };

    try {
      // Crear instancia de panzoom
      const panzoom = Panzoom(element, defaultOptions);
      panzoomInstanceRef.current = panzoom;

      // Habilitar zoom con la rueda del mouse y trackpad
      const parent = element.parentElement;
      if (parent) {
        // Usar passive: false para permitir preventDefault y mejorar trackpad
        parent.addEventListener('wheel', panzoom.zoomWithWheel, { passive: false });

        // Habilitar gestos touch para móviles
        element.addEventListener('touchstart', (e) => {
          if (e.touches.length > 1) {
            e.preventDefault(); // Prevenir zoom del navegador
          }
        }, { passive: false });
      }

      // Actualizar estado cuando cambia la transformación
      const updateState = (event) => {
        const { scale, x, y } = event.detail;
        setPanzoomState({ scale, x, y });
      };

      element.addEventListener('panzoomchange', updateState);

      // Estado inicial
      setPanzoomState({
        scale: panzoom.getScale(),
        x: panzoom.getPan().x,
        y: panzoom.getPan().y,
      });

      setIsReady(true);

      console.log('✅ Panzoom inicializado correctamente con soporte para wheel, trackpad y touch');

      // Cleanup
      return () => {
        if (parent) {
          parent.removeEventListener('wheel', panzoom.zoomWithWheel);
        }
        element.removeEventListener('panzoomchange', updateState);
        panzoom.destroy();
        panzoomInstanceRef.current = null;
        setIsReady(false);
      };
    } catch (error) {
      console.error('Error inicializando panzoom:', error);
      return undefined;
    }
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [element, panzoomOptions]);

  /**
   * Hace zoom in
   */
  const zoomIn = useCallback((options) => {
    if (panzoomInstanceRef.current) {
      panzoomInstanceRef.current.zoomIn(options);
    }
  }, []);

  /**
   * Hace zoom out
   */
  const zoomOut = useCallback((options) => {
    if (panzoomInstanceRef.current) {
      panzoomInstanceRef.current.zoomOut(options);
    }
  }, []);

  /**
   * Establece el zoom a un valor específico
   */
  const zoom = useCallback((scale, options) => {
    if (panzoomInstanceRef.current) {
      panzoomInstanceRef.current.zoom(scale, options);
    }
  }, []);

  /**
   * Hace pan a una posición específica
   */
  const pan = useCallback((x, y, options) => {
    if (panzoomInstanceRef.current) {
      panzoomInstanceRef.current.pan(x, y, options);
    }
  }, []);

  /**
   * Resetea el zoom y pan al estado inicial
   */
  const reset = useCallback((options) => {
    if (panzoomInstanceRef.current) {
      panzoomInstanceRef.current.reset(options);
    }
  }, []);

  /**
   * Obtiene la escala actual
   */
  const getScale = useCallback(() => {
    if (panzoomInstanceRef.current) {
      return panzoomInstanceRef.current.getScale();
    }
    return 1;
  }, []);

  /**
   * Obtiene el pan actual
   */
  const getPan = useCallback(() => {
    if (panzoomInstanceRef.current) {
      return panzoomInstanceRef.current.getPan();
    }
    return { x: 0, y: 0 };
  }, []);

  /**
   * Centra el contenido en el viewport
   */
  const center = useCallback((options) => {
    if (panzoomInstanceRef.current &amp;&amp; elementRef?.current) {
      const element = elementRef.current;
      const parent = element.parentElement;

      if (parent) {
        const parentRect = parent.getBoundingClientRect();
        const elementRect = element.getBoundingClientRect();

        const x = (parentRect.width - elementRect.width) / 2;
        const y = (parentRect.height - elementRect.height) / 2;

        panzoomInstanceRef.current.pan(x, y, options);
      }
    }
  }, [elementRef]);

  return {
    // Estado
    panzoomState,
    isReady,
    instance: panzoomInstanceRef.current,

    // Métodos de control
    zoomIn,
    zoomOut,
    zoom,
    pan,
    reset,
    center,
    getScale,
    getPan,
  };
}

export default usePanzoom;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="CoordinateTransformer.html">CoordinateTransformer</a></li><li><a href="PathDataProcessor.html">PathDataProcessor</a></li><li><a href="SVGOptimizer.html">SVGOptimizer</a></li><li><a href="SVGWorld.html">SVGWorld</a></li></ul><h3>Global</h3><ul><li><a href="global.html#AdvancedTools">AdvancedTools</a></li><li><a href="global.html#BezierHandleEditor">BezierHandleEditor</a></li><li><a href="global.html#CodeView">CodeView</a></li><li><a href="global.html#Container">Container</a></li><li><a href="global.html#DEFAULT_CONFIG">DEFAULT_CONFIG</a></li><li><a href="global.html#FileLoadDemo">FileLoadDemo</a></li><li><a href="global.html#LanguageSelector">LanguageSelector</a></li><li><a href="global.html#MousePointerIcon">MousePointerIcon</a></li><li><a href="global.html#MoveableWrapper">MoveableWrapper</a></li><li><a href="global.html#NodeEditor">NodeEditor</a></li><li><a href="global.html#PathDebugger">PathDebugger</a></li><li><a href="global.html#PerformanceMetrics">PerformanceMetrics</a></li><li><a href="global.html#SVGHierarchy">SVGHierarchy</a></li><li><a href="global.html#SVGHistory">SVGHistory</a></li><li><a href="global.html#SVGMetadataEditor">SVGMetadataEditor</a></li><li><a href="global.html#SVGViewer">SVGViewer</a></li><li><a href="global.html#SettingsModal">SettingsModal</a></li><li><a href="global.html#SettingsView">SettingsView</a></li><li><a href="global.html#StylePanel">StylePanel</a></li><li><a href="global.html#TextInput">TextInput</a></li><li><a href="global.html#absoluteToRelative">absoluteToRelative</a></li><li><a href="global.html#addNodeToPath">addNodeToPath</a></li><li><a href="global.html#applyTransform">applyTransform</a></li><li><a href="global.html#buildPathFromNodes">buildPathFromNodes</a></li><li><a href="global.html#buildPathString">buildPathString</a></li><li><a href="global.html#checkLocalStorageAvailable">checkLocalStorageAvailable</a></li><li><a href="global.html#checkSessionStorageAvailable">checkSessionStorageAvailable</a></li><li><a href="global.html#circleToPath">circleToPath</a></li><li><a href="global.html#clearLocalStorage">clearLocalStorage</a></li><li><a href="global.html#clearSessionStorage">clearSessionStorage</a></li><li><a href="global.html#closePath">closePath</a></li><li><a href="global.html#countElements">countElements</a></li><li><a href="global.html#createCoordinateTransformer">createCoordinateTransformer</a></li><li><a href="global.html#createPathDataProcessor">createPathDataProcessor</a></li><li><a href="global.html#createSVGOptimizer">createSVGOptimizer</a></li><li><a href="global.html#createSVGWorld">createSVGWorld</a></li><li><a href="global.html#ellipseToPath">ellipseToPath</a></li><li><a href="global.html#formatNumber">formatNumber</a></li><li><a href="global.html#getElementBBox">getElementBBox</a></li><li><a href="global.html#getLocalStorageSize">getLocalStorageSize</a></li><li><a href="global.html#getSessionStorageSize">getSessionStorageSize</a></li><li><a href="global.html#getTransformedBBox">getTransformedBBox</a></li><li><a href="global.html#moveElement">moveElement</a></li><li><a href="global.html#optimizeSVG">optimizeSVG</a></li><li><a href="global.html#parsePathCommand">parsePathCommand</a></li><li><a href="global.html#parsePathNodes">parsePathNodes</a></li><li><a href="global.html#parseTransform">parseTransform</a></li><li><a href="global.html#pointToHorizontalLine">pointToHorizontalLine</a></li><li><a href="global.html#pointToLineTo">pointToLineTo</a></li><li><a href="global.html#pointToMoveTo">pointToMoveTo</a></li><li><a href="global.html#pointToSmoothQuadraticBezier">pointToSmoothQuadraticBezier</a></li><li><a href="global.html#pointToVerticalLine">pointToVerticalLine</a></li><li><a href="global.html#pointsToArc">pointsToArc</a></li><li><a href="global.html#pointsToCubicBezier">pointsToCubicBezier</a></li><li><a href="global.html#pointsToPath">pointsToPath</a></li><li><a href="global.html#pointsToQuadraticBezier">pointsToQuadraticBezier</a></li><li><a href="global.html#pointsToSmoothCubicBezier">pointsToSmoothCubicBezier</a></li><li><a href="global.html#rectToPath">rectToPath</a></li><li><a href="global.html#relativeToAbsolute">relativeToAbsolute</a></li><li><a href="global.html#removeNodeFromPath">removeNodeFromPath</a></li><li><a href="global.html#rotateElement">rotateElement</a></li><li><a href="global.html#scaleElement">scaleElement</a></li><li><a href="global.html#serializeTransform">serializeTransform</a></li><li><a href="global.html#simplifyPath">simplifyPath</a></li><li><a href="global.html#svgToScreenCoords">svgToScreenCoords</a></li><li><a href="global.html#updateNodeInPath">updateNodeInPath</a></li><li><a href="global.html#useCoordinateTransformer">useCoordinateTransformer</a></li><li><a href="global.html#useHistory">useHistory</a></li><li><a href="global.html#useLocalStorage">useLocalStorage</a></li><li><a href="global.html#useMoveable">useMoveable</a></li><li><a href="global.html#usePanzoom">usePanzoom</a></li><li><a href="global.html#usePathDataProcessor">usePathDataProcessor</a></li><li><a href="global.html#usePerformance">usePerformance</a></li><li><a href="global.html#useSVGParser">useSVGParser</a></li><li><a href="global.html#useSVGStorage">useSVGStorage</a></li><li><a href="global.html#useSVGWorld">useSVGWorld</a></li><li><a href="global.html#useSessionStorage">useSessionStorage</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Mon Nov 17 2025 13:59:29 GMT+1300 (New Zealand Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
