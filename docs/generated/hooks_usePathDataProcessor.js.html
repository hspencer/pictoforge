<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: hooks/usePathDataProcessor.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: hooks/usePathDataProcessor.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { useState, useCallback, useEffect, useRef } from 'react';
import { createPathDataProcessor } from '../services/PathDataProcessor';

/**
 * Hook React para integrar el PathDataProcessor con el ciclo de vida de React
 * Proporciona acceso reactivo a la manipulación de paths SVG
 *
 * @param {Object} options - Opciones de configuración
 * @param {string} options.pathString - Cadena 'd' inicial del path
 * @param {boolean} options.autoNormalize - Normalizar automáticamente a comandos absolutos
 * @returns {Object} API del processor de paths
 */
export function usePathDataProcessor({ pathString = '', autoNormalize = true } = {}) {
  const processorRef = useRef(null);
  const [segments, setSegments] = useState([]);
  const [anchorPoints, setAnchorPoints] = useState([]);
  const [controlPoints, setControlPoints] = useState([]);
  const [isReady, setIsReady] = useState(false);
  const [currentPathString, setCurrentPathString] = useState(pathString);

  /**
   * Inicializa o actualiza el processor cuando cambia el pathString
   */
  useEffect(() => {
    if (!pathString) {
      processorRef.current = null;
      setSegments([]);
      setAnchorPoints([]);
      setControlPoints([]);
      setIsReady(false);
      return;
    }

    try {
      const processor = createPathDataProcessor(pathString);

      if (autoNormalize) {
        processor.normalize();
      }

      processorRef.current = processor;
      setCurrentPathString(pathString);
      updateState();
      setIsReady(true);
    } catch (error) {
      console.error('Error inicializando PathDataProcessor:', error);
      setIsReady(false);
    }
  }, [pathString, autoNormalize]);

  /**
   * Actualiza el estado reactivo desde el processor
   */
  const updateState = useCallback(() => {
    if (!processorRef.current) return;

    try {
      setSegments(processorRef.current.getSegments());
      setAnchorPoints(processorRef.current.getAnchorPoints());
      setControlPoints(processorRef.current.getControlPoints());
      setCurrentPathString(processorRef.current.toString());
    } catch (error) {
      console.error('Error actualizando estado del processor:', error);
    }
  }, []);

  /**
   * Normaliza el path a comandos absolutos
   */
  const normalize = useCallback(() => {
    if (!processorRef.current) {
      console.warn('usePathDataProcessor: Processor no inicializado');
      return;
    }

    processorRef.current.normalize();
    updateState();
  }, [updateState]);

  /**
   * Actualiza un punto de anclaje
   * @param {number} segmentIndex - Índice del segmento
   * @param {Object} newPosition - Nueva posición { x, y }
   */
  const updateAnchorPoint = useCallback((segmentIndex, newPosition) => {
    if (!processorRef.current) {
      console.warn('usePathDataProcessor: Processor no inicializado');
      return;
    }

    processorRef.current.updateAnchorPoint(segmentIndex, newPosition);
    updateState();
  }, [updateState]);

  /**
   * Actualiza un punto de control
   * @param {number} segmentIndex - Índice del segmento
   * @param {string} controlType - Tipo de control: 'C1', 'C2', 'Q1'
   * @param {Object} newPosition - Nueva posición { x, y }
   */
  const updateControlPoint = useCallback((segmentIndex, controlType, newPosition) => {
    if (!processorRef.current) {
      console.warn('usePathDataProcessor: Processor no inicializado');
      return;
    }

    processorRef.current.updateControlPoint(segmentIndex, controlType, newPosition);
    updateState();
  }, [updateState]);

  /**
   * Invierte la dirección del path
   */
  const reverse = useCallback(() => {
    if (!processorRef.current) {
      console.warn('usePathDataProcessor: Processor no inicializado');
      return;
    }

    processorRef.current.reverse();
    updateState();
  }, [updateState]);

  /**
   * Obtiene el path como string
   * @returns {string} Cadena 'd' del path
   */
  const toString = useCallback(() => {
    if (!processorRef.current) {
      return '';
    }
    return processorRef.current.toString();
  }, []);

  /**
   * Obtiene los comandos como strings legibles
   * @returns {Array&lt;string>} Array de comandos
   */
  const toCommandStrings = useCallback(() => {
    if (!processorRef.current) {
      return [];
    }
    return processorRef.current.toCommandStrings();
  }, []);

  /**
   * Clona el processor actual
   * @returns {PathDataProcessor} Nuevo processor
   */
  const clone = useCallback(() => {
    if (!processorRef.current) {
      return null;
    }
    return processorRef.current.clone();
  }, []);

  /**
   * Obtiene información de debug
   * @returns {Object} Información de debug
   */
  const getDebugInfo = useCallback(() => {
    if (!processorRef.current) {
      return null;
    }
    return processorRef.current.getDebugInfo();
  }, []);

  /**
   * Limpia el processor
   */
  const clear = useCallback(() => {
    if (processorRef.current) {
      processorRef.current.clear();
    }
    setSegments([]);
    setAnchorPoints([]);
    setControlPoints([]);
    setIsReady(false);
    setCurrentPathString('');
  }, []);

  /**
   * Parsea un nuevo path string
   * @param {string} newPathString - Nueva cadena 'd'
   */
  const parse = useCallback((newPathString) => {
    if (!newPathString) {
      clear();
      return;
    }

    try {
      const processor = createPathDataProcessor(newPathString);

      if (autoNormalize) {
        processor.normalize();
      }

      processorRef.current = processor;
      updateState();
      setIsReady(true);
    } catch (error) {
      console.error('Error parseando path:', error);
      setIsReady(false);
    }
  }, [autoNormalize, clear, updateState]);

  return {
    // Estado
    isReady,
    processor: processorRef.current,
    segments,
    anchorPoints,
    controlPoints,
    pathString: currentPathString,

    // Métodos de transformación
    normalize,
    reverse,

    // Métodos de modificación
    updateAnchorPoint,
    updateControlPoint,

    // Métodos de conversión
    toString,
    toCommandStrings,

    // Utilidades
    parse,
    clone,
    clear,
    getDebugInfo,
  };
}

export default usePathDataProcessor;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="CoordinateTransformer.html">CoordinateTransformer</a></li><li><a href="PathDataProcessor.html">PathDataProcessor</a></li><li><a href="SVGOptimizer.html">SVGOptimizer</a></li><li><a href="SVGWorld.html">SVGWorld</a></li></ul><h3>Global</h3><ul><li><a href="global.html#AdvancedTools">AdvancedTools</a></li><li><a href="global.html#BezierHandleEditor">BezierHandleEditor</a></li><li><a href="global.html#CodeView">CodeView</a></li><li><a href="global.html#Container">Container</a></li><li><a href="global.html#DEFAULT_CONFIG">DEFAULT_CONFIG</a></li><li><a href="global.html#FileLoadDemo">FileLoadDemo</a></li><li><a href="global.html#LanguageSelector">LanguageSelector</a></li><li><a href="global.html#MousePointerIcon">MousePointerIcon</a></li><li><a href="global.html#MoveableWrapper">MoveableWrapper</a></li><li><a href="global.html#NodeEditor">NodeEditor</a></li><li><a href="global.html#PathDebugger">PathDebugger</a></li><li><a href="global.html#PerformanceMetrics">PerformanceMetrics</a></li><li><a href="global.html#SVGHierarchy">SVGHierarchy</a></li><li><a href="global.html#SVGHistory">SVGHistory</a></li><li><a href="global.html#SVGMetadataEditor">SVGMetadataEditor</a></li><li><a href="global.html#SVGViewer">SVGViewer</a></li><li><a href="global.html#SettingsModal">SettingsModal</a></li><li><a href="global.html#SettingsView">SettingsView</a></li><li><a href="global.html#StylePanel">StylePanel</a></li><li><a href="global.html#TextInput">TextInput</a></li><li><a href="global.html#absoluteToRelative">absoluteToRelative</a></li><li><a href="global.html#addNodeToPath">addNodeToPath</a></li><li><a href="global.html#applyTransform">applyTransform</a></li><li><a href="global.html#buildPathFromNodes">buildPathFromNodes</a></li><li><a href="global.html#buildPathString">buildPathString</a></li><li><a href="global.html#checkLocalStorageAvailable">checkLocalStorageAvailable</a></li><li><a href="global.html#checkSessionStorageAvailable">checkSessionStorageAvailable</a></li><li><a href="global.html#circleToPath">circleToPath</a></li><li><a href="global.html#clearLocalStorage">clearLocalStorage</a></li><li><a href="global.html#clearSessionStorage">clearSessionStorage</a></li><li><a href="global.html#closePath">closePath</a></li><li><a href="global.html#countElements">countElements</a></li><li><a href="global.html#createCoordinateTransformer">createCoordinateTransformer</a></li><li><a href="global.html#createPathDataProcessor">createPathDataProcessor</a></li><li><a href="global.html#createSVGOptimizer">createSVGOptimizer</a></li><li><a href="global.html#createSVGWorld">createSVGWorld</a></li><li><a href="global.html#ellipseToPath">ellipseToPath</a></li><li><a href="global.html#formatNumber">formatNumber</a></li><li><a href="global.html#getElementBBox">getElementBBox</a></li><li><a href="global.html#getLocalStorageSize">getLocalStorageSize</a></li><li><a href="global.html#getSessionStorageSize">getSessionStorageSize</a></li><li><a href="global.html#getTransformedBBox">getTransformedBBox</a></li><li><a href="global.html#moveElement">moveElement</a></li><li><a href="global.html#optimizeSVG">optimizeSVG</a></li><li><a href="global.html#parsePathCommand">parsePathCommand</a></li><li><a href="global.html#parsePathNodes">parsePathNodes</a></li><li><a href="global.html#parseTransform">parseTransform</a></li><li><a href="global.html#pointToHorizontalLine">pointToHorizontalLine</a></li><li><a href="global.html#pointToLineTo">pointToLineTo</a></li><li><a href="global.html#pointToMoveTo">pointToMoveTo</a></li><li><a href="global.html#pointToSmoothQuadraticBezier">pointToSmoothQuadraticBezier</a></li><li><a href="global.html#pointToVerticalLine">pointToVerticalLine</a></li><li><a href="global.html#pointsToArc">pointsToArc</a></li><li><a href="global.html#pointsToCubicBezier">pointsToCubicBezier</a></li><li><a href="global.html#pointsToPath">pointsToPath</a></li><li><a href="global.html#pointsToQuadraticBezier">pointsToQuadraticBezier</a></li><li><a href="global.html#pointsToSmoothCubicBezier">pointsToSmoothCubicBezier</a></li><li><a href="global.html#rectToPath">rectToPath</a></li><li><a href="global.html#relativeToAbsolute">relativeToAbsolute</a></li><li><a href="global.html#removeNodeFromPath">removeNodeFromPath</a></li><li><a href="global.html#rotateElement">rotateElement</a></li><li><a href="global.html#scaleElement">scaleElement</a></li><li><a href="global.html#serializeTransform">serializeTransform</a></li><li><a href="global.html#simplifyPath">simplifyPath</a></li><li><a href="global.html#svgToScreenCoords">svgToScreenCoords</a></li><li><a href="global.html#updateNodeInPath">updateNodeInPath</a></li><li><a href="global.html#useCoordinateTransformer">useCoordinateTransformer</a></li><li><a href="global.html#useHistory">useHistory</a></li><li><a href="global.html#useLocalStorage">useLocalStorage</a></li><li><a href="global.html#useMoveable">useMoveable</a></li><li><a href="global.html#usePanzoom">usePanzoom</a></li><li><a href="global.html#usePathDataProcessor">usePathDataProcessor</a></li><li><a href="global.html#usePerformance">usePerformance</a></li><li><a href="global.html#useSVGParser">useSVGParser</a></li><li><a href="global.html#useSVGStorage">useSVGStorage</a></li><li><a href="global.html#useSVGWorld">useSVGWorld</a></li><li><a href="global.html#useSessionStorage">useSessionStorage</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Mon Nov 17 2025 13:59:29 GMT+1300 (New Zealand Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
